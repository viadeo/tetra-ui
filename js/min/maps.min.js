/*! Tetra UI v1.2.9 | (MIT Licence) (c) Viadeo/APVO Corp - inspired by Bootstrap (c) Twitter, Inc. (Apache 2 Licence) */

tetra.controller.register("api",{scope:"maps",constr:function(a,b,c){return{events:{view:{"maps: load api":function(b){a.methods.loadscript(b)},"maps: api loaded":function(){c.notify("maps: api loaded")}},controller:{"maps: load api":function(b){a.methods.loadscript(b)}}},methods:{init:function(){},loadscript:function(a){var b=a.key?a.key:"",c=a.version?a.version:"3",d=a.language?a.language:"",e=a.libraries?a.libraries:"",f="http://maps.googleapis.com/maps/api/js?",g=document.createElement("script");g.type="text/javascript",g.src=f+"key="+b+"&v="+c+"&language="+d+"&libraries="+e+"&sensor=false&callback=mapsApiLoaded",document.body.appendChild(g),window.mapsApiLoaded=function(){tetra.controller.notify("maps: api loaded",{},"maps");try{delete window.mapsApiLoaded}catch(a){}}}}}}}),tetra.controller.register("map",{scope:"maps",constr:function(a){return{events:{controller:{"maps: api loaded":function(){a.maps={},a.markers={},a.infoWindow={},a.center={},a.bounds={}},"maps: set map":function(b){if("undefined"!=typeof google){var c={zoom:12,zoomControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},mapTypeControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP},d=new google.maps.Map(document.getElementById(b.mapId),c);a.markers[b.mapId]=[],a.center[b.mapId]=d.getCenter(),a.bounds[b.mapId]=new google.maps.LatLngBounds,a.maps[b.mapId]=d,a.infoWindow[b.mapId]=new google.maps.InfoWindow({maxWidth:300}),google.maps.visualRefresh=!0,a.methods.setStyle_314(d),document.getElementById(b.mapId).style.lineHeight="normal"}},"maps: set options":function(b){a.maps[b.mapId].setOptions(b.options)},"maps: get map":function(b){b.cbk(a.maps[b.mapId])},"maps: set marker":function(b){var c=new google.maps.Marker({map:a.maps[b.mapId],position:new google.maps.LatLng(b.latLng[0],b.latLng[1]),title:b.title});a.bounds[b.mapId].extend(new google.maps.LatLng(b.latLng[0],b.latLng[1])),a.markers[b.mapId].push(c),b.infoWindow&&a.methods.setInfoWindow({mapId:b.mapId,marker:c,content:b.infoWindow.content,event:b.infoWindow.event}),b.cbk&&b.cbk(c)},"maps: unset marker":function(a){a.setMap(null)},"maps: unset markers":function(b){for(var c=a.markers[b],d=0,e=c.length;e>d;d++)c[d].setMap(null)},"maps: get markers":function(b){b.cbk(a.markers[b.mapId])},"maps: set center":function(b){a.maps[b.mapId].setCenter(new google.maps.LatLng(b.latLng[0],b.latLng[1])),a.center[b.mapId]=a.maps[b.mapId].getCenter()},"maps: fit bounds":function(b){a.markers[b].length>0&&(a.maps[b].fitBounds(a.bounds[b]),google.maps.event.addListenerOnce(a.maps[b],"bounds_changed",function(){a.maps[b].setZoom(Math.min(12,Math.max(2,a.maps[b].getZoom())))}),a.center[b]=a.bounds[b].getCenter())},"maps: set bounds":function(b){a.bounds[b.mapId]=new google.maps.LatLngBounds(b.latLng[0],b.latLng[1])},"maps: set zoom":function(b){a.maps[b.mapId].setZoom(b.zoom)},"maps: set infoWindow":function(b){a.methods.setInfoWindow(b)}}},methods:{setInfoWindow:function(b){google.maps.event.addListenerOnce(a.maps[b.mapId],"idle",function(){"string"==typeof b.content&&""!==b.content&&(google.maps.event.addListener(b.marker,"click",function(){a.infoWindow[b.mapId].setContent(b.content),a.infoWindow[b.mapId].open(a.maps[b.mapId],b.marker)}),google.maps.event.addListener(a.infoWindow[b.mapId],"closeclick",function(){a.maps[b.mapId].panTo(a.center[b.mapId])}),"string"==typeof b.event&&"onload"===b.event&&setTimeout(function(){google.maps.event.trigger(b.marker,"click")},100))})},getMarkerIcon:function(){return new google.maps.MarkerImage("/v_img/global/marker.png",new google.maps.Size(50,45),new google.maps.Point(0,0),new google.maps.Point(18,45))},getMarkerShape:function(){return{coord:[22,0,25,1,28,2,29,3,30,4,32,5,32,6,33,7,34,8,35,9,35,10,35,11,36,12,36,13,36,14,37,15,37,16,37,17,37,18,37,19,37,20,37,21,37,22,36,23,36,24,36,25,35,26,35,27,35,28,34,29,33,30,33,31,32,32,32,33,31,34,30,35,30,36,29,37,29,38,28,39,27,40,27,41,26,42,26,43,25,44,24,45,24,46,23,47,23,48,22,49,19,50,18,50,15,49,14,48,14,47,13,46,13,45,12,44,11,43,11,42,10,41,10,40,9,39,8,38,8,37,7,36,7,35,6,34,5,33,5,32,4,31,4,30,3,29,2,28,2,27,2,26,1,25,1,24,1,23,0,22,0,21,0,20,0,19,0,18,0,17,0,16,0,15,1,14,1,13,1,12,2,11,2,10,2,9,3,8,4,7,5,6,5,5,7,4,8,3,9,2,12,1,15,0,22,0],type:"poly"}},setStyle_314:function(a){var b=[{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{hue:"#ff8800"},{gamma:1},{saturation:-87},{lightness:29}]},{featureType:"road",elementType:"geometry.fill",stylers:[{lightness:100}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"on"},{hue:"#d9ccbe"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{visibility:"on"},{lightness:0},{color:"#c8df9f"}]}];a.setOptions({styles:b})},setStyle:function(a){var b=[{featureType:"landscape",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{visibility:"on"},{color:"#e8e0d8"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#73b6e6"}]},{featureType:"water",elementType:"labels",stylers:[{color:"#2a75aa"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{lightness:100},{weight:2}]},{featureType:"road",elementType:"geometry.fill",stylers:[{lightness:100}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{hue:"#ff8800"},{gamma:1},{saturation:-87},{lightness:29}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{lightness:100}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{hue:"#ff8800"},{gamma:1},{saturation:-87},{lightness:29}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#000000"}]},{featureType:"road.arterial",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{hue:"0xffffff"},{lightness:100},{weight:2.5}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#7a7a7a"}]},{featureType:"road.local",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry",stylers:[{visibility:"on"},{color:"#5b5b5b"},{weight:.5}]},{featureType:"administrative.country",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{lightness:100},{weight:3}]},{featureType:"administrative.locality",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{lightness:100},{weight:4.9}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#d9ccbe"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{visibility:"on"},{lightness:0},{color:"#c8df9f"}]}];a.setOptions({styles:b})}}}}}),tetra.controller.register("geocode",{scope:"maps",constr:function(){return{events:{controller:{"maps: geocode":function(a){if("undefined"!=typeof google){var b=new google.maps.Geocoder;b.geocode(a,function(b,c){return c!==google.maps.GeocoderStatus.OK?a.cbk(null):a.hasOwnProperty("address")?a.cbk(b[0]):a.hasOwnProperty("latlng")?a.cbk(b[1].formatted_address):void 0})}}}},methods:{}}}}),tetra.controller.register("itinerary",{scope:"maps",constr:function(a,b,c){return{events:{controller:{"maps: api loaded":function(){a.directionsDisplay={},a.directionsService={}},"maps: set itinerary":function(b){if("undefined"!=typeof google){var c=b.origin,d=b.destination,e=b.mode,f=b.mapId,g=b.cbk;a.methods.start_service(b);var h={origin:c,destination:d,travelMode:google.maps.TravelMode[e],durationInTraffic:!0};a.directionsDisplay[f].setDirections({routes:[]}),a.directionsService.route(h,function(b,c){c===google.maps.DirectionsStatus.OK&&a.directionsDisplay[f].setDirections(b),g(c,b)})}},"maps: unset itinerary":function(b){a.directionsDisplay[b].setDirections({routes:[]})}}},methods:{start_service:function(b){a.directionsDisplay[b.mapId]||(a.directionsService=new google.maps.DirectionsService,c.notify("maps: get map",{mapId:b.mapId,cbk:function(c){a.directionsDisplay[b.mapId]=new google.maps.DirectionsRenderer,a.directionsDisplay[b.mapId].setMap(c),a.directionsDisplay[b.mapId].setPanel(document.getElementById(b.panelId))}}))}}}}}),tetra.controller.register("places",{scope:"maps",constr:function(){return{events:{controller:{"maps: places":function(){"undefined"==typeof google}}},methods:{init:function(){}}}}});