/*! Tetra UI v1.2.9 | (MIT Licence) (c) Viadeo/APVO Corp - inspired by Bootstrap (c) Twitter, Inc. (Apache 2 Licence) */

tetra.model.register("navtabs",{scope:"navtabs",req:{fetch:{url:"{0}",uriParams:["url"],parser:function(a,b,c){return b[c.uriParams.url]={id:c.uriParams.url,targetId:c.targetId,html:a.toString()},b}}},attr:{html:"",targetId:""},methods:function(){return{validate:function(a,b){return b}}}}),tetra.controller.register("navtabs",{scope:"navtabs",use:["navtabs"],constr:function(a,b,c,d){"use strict";return{events:{model:{navtabs:{append:function(c){var d=c[0];a.currentContent=d.get("html"),b.notify("end loading",{targetId:d.get("targetId")}).notify("set content",{targetId:d.get("targetId"),content:a.currentContent,tabRef:a.tabRef[a.tabRef.length-1]})},error:function(c){a.tabRef.pop(),b.notify("end loading",{targetId:c.obj.get("targetId")}).notify("show error").notify("set content",{targetId:c.obj.get("targetId"),content:a.currentContent,tabRef:a.tabRef[a.tabRef.length-1]})}}},view:{"show tab":function(c){a.tabRef.push(c.url),b.notify("start loading",{targetId:c.targetId}),c.uriParams={url:c.url},d("navtabs").fetch(c)}}},methods:{init:function(){a.currentContent="",a.tabRef=[]}}}}}),tetra.view.register("navtabs",{scope:"navtabs",use:["navtabs"],constr:function(a,b,c){"use strict";return{events:{user:{click:{".nav a[data-href]":function(c,d){var e={url:d.attr("data-href"),targetId:d.parents(".nav").attr("data-target-id")};a.methods.setActiveTab(d),b.notify("show tab",e)},".nav a[data-section]":function(b,d){var e=d.parents(".nav").attr("data-target-id");c("#"+e).find(".section").removeClass("active"),c("#"+d.attr("data-section")).addClass("active"),a.methods.setActiveTab(d)}}},controller:{"start loading":function(a){c("#"+a.targetId).addClass("loading")},"end loading":function(a){c("#"+a.targetId).removeClass("loading")},"set content":function(b){c("#"+b.targetId).children(".section").html(b.content);var d=c(".nav-tabs[data-target-id="+b.targetId+"]").find('a[data-href="'+b.tabRef+'"]');a.methods.setActiveTab(d)},"show error":function(){VNS.ui.growl(lang["notification.modification.save.error"])}}},methods:{init:function(){c(".nav-tabs li.active a").click()},setActiveTab:function(a){a.parent().addClass("active").siblings().removeClass("active")}}}}});