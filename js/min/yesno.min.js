/*! Tetra UI v1.2.9 | (MIT Licence) (c) Viadeo/APVO Corp - inspired by Bootstrap (c) Twitter, Inc. (Apache 2 Licence) */

tetra.model.register("yesno",{scope:"yesno",req:{save:{url:"{0}",uriParams:["url"],method:"POST"},del:{url:"{0}",uriParams:["url"],method:"POST"}},attr:{status:!0,param:""},methods:function(a){return{validate:function(a,b){return b},setCustom:function(b){return a[b.name]=b.value,this}}}}),tetra.controller.register("yesno",{scope:"yesno",use:["yesno"],constr:function(a,b,c,d){"use strict";return{events:{model:{yesno:{error:function(a){b.notify("switchback yesno after error",a.obj)}}},view:{"save state":function(a){"undefined"!=typeof a.oparam?d("yesno").create({}).setCustom(a.oparam).save({param:a.param,status:!0,uriParams:{url:a.url}}):d("yesno").create({}).save({param:a.param,status:!0,uriParams:{url:a.url}})},"delete state":function(a){"undefined"!=typeof a.oparam?d("yesno").create({}).setCustom(a.oparam).remove({param:a.param,status:!1,uriParams:{url:a.url}}):d("yesno").create({}).remove({param:a.param,status:!1,uriParams:{url:a.url}})}}},methods:{init:function(){}}}}}),tetra.view.register("yesno",{use:["yesno"],scope:"yesno",constr:function(a,b,c){"use strict";return{events:{user:{click:{".btn-yn":function(b,d){(c(d).hasClass("btn-yes")&&c(b.target).hasClass("lnk-no")||c(d).hasClass("btn-no")&&c(b.target).hasClass("lnk-yes"))&&a.methods.switchstate(d)}}},controller:{"switchback yesno after error":function(b){a.methods.switchback(c("[data-param = "+b.get("param")+"]"),b.get("status")),VNS.ui.growl(lang["notification.modification.save.error"])}}},methods:{init:function(){},switchstate:function(a){if("allowIndexing"===a.attr("data-param")&&(a.hasClass("btn-no")?(c("#lightProfileBox").removeClass("hidden"),c("#blockChangeNickname").removeClass("hidden")):(c("#lightProfileBox").addClass("hidden"),c("#blockChangeNickname").addClass("hidden"))),"lightPublicProfile"===a.attr("data-param")){var d=c("#lightPublicProfileTooltip").find("a")[0].href,e=d.indexOf("&ts=");e>0&&(d=d.substring(0,e)),d+="&ts="+(new Date).getTime(),c("#lightPublicProfileTooltip").find("a")[0].href=d,a.hasClass("btn-no")?c("#lightPublicProfileTooltip").addClass("lightPublicProfileNoMode"):c("#lightPublicProfileTooltip").removeClass("lightPublicProfileNoMode")}var f;""!==a.attr("data-opname")&&(f={name:a.attr("data-opname"),value:a.attr("data-opvalue")}),a.hasClass("btn-no")?(a.removeClass("btn-no").addClass("btn-yes"),b.notify("save state",{url:a.attr("data-url"),param:a.attr("data-param"),oparam:f})):(a.addClass("btn-no").removeClass("btn-yes"),b.notify("delete state",{url:a.attr("data-url"),param:a.attr("data-param"),oparam:f}))},switchback:function(a,b){b?a.addClass("btn-no").removeClass("btn-yes"):a.removeClass("btn-no").addClass("btn-yes")}}}}});